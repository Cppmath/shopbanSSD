var products = [
    {
        id: 0,
        img: './assets/img/sp/0',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 1,
        img: './assets/img/sp/1',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 2,
        img: './assets/img/sp/2',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 3,
        img: './assets/img/sp/3',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 4,
        img: './assets/img/sp/4',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 5,
        img: './assets/img/sp/5',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 6,
        img: './assets/img/sp/6',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 7,
        img: './assets/img/sp/7',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 8,
        img: './assets/img/sp/8',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 9,
        img: './assets/img/sp/9',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 10,
        img: './assets/img/sp/10',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 11,
        img: './assets/img/sp/11',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 12,
        img: './assets/img/sp/12',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 13,
        img: './assets/img/sp/13',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 14,
        img: './assets/img/sp/14',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 15,
        img: './assets/img/sp/15',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 16,
        img: './assets/img/sp/16',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 17,
        img: './assets/img/sp/17',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 18,
        img: './assets/img/sp/18',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 19,
        img: './assets/img/sp/19',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 20,
        img: './assets/img/sp/20',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 21,
        img: './assets/img/sp/21',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 22,
        img: './assets/img/sp/22',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    },
    {
        id: 23,
        img: './assets/img/sp/23',
        title: 'SSD MSI SPATIUM S270 2.5-Inch SATA III 120GB SPATIUM-S270-120GB',
        price: 280.000,
        oldPrice: 530.000,
        luotMua: 0,
        desc: 'Chuẩn SSD: 2.5 inches Tốc độ đọc: 500 MB/s Tốc độ ghi: 360 MB/s Bảo hành chính hãng 3 năm.',
        sale: 29,
        rate: 5,
        vote: 100,
    }   
]

var tongLuotMua = 0;
var tongTien = 0;

const $ = document.querySelector.bind(document)
const $$ = document.querySelectorAll.bind(document)

const productList = $('.main-product-list')
const cartNumber = $('.header-cart-number')
const cartItemList = $('.buy-done-list')
const tienElement = $('.buy-done-total-coin')
const mainProductList = $('.main-product-list')

// tinh tong tien
function tinhTien() {
        tongTien = 
            products.filter(product => product.luotMua > 0)
                    .reduce((total,product) => total + product.luotMua * product.price, 0)
    tienElement.innerHTML = `${tongTien}.000đ`     
}

// render sp
productList.innerHTML = products.map((product, index) => {
    return `
    <!-- product-item 0-->
    <div class="product-item" data-index = "${product.id}">
        <div class="product-modal">
            <div class="product-modal-buy" data-index="${product.id}">
                <i class="product-modal-buy-icon fa-solid fa-cart-plus"></i>
            </div>
            <div class="product-modal-show">
                <i class="product-modal-show-icon fa-solid fa-eye"></i>
            </div>
        </div>
        <div class="product-item-sale">
            -${product.sale}%
        </div>
        <img class="product-item-img" src="${product.img + '.webp'}" alt="">
        <span class="product-item-title">
            ${product.title}
        </span>
        <div class="product-item-price">
            <span class="product-item-current_price">
                ${product.price + '.000đ'}
            </span>
            <span class="product-item-before_price">
                ${product.oldPrice + '.000đ'}
            </span>
        </div>
        <div class="product-item-rate">
            <i class="product-item-rate-icon fa-solid fa-star"></i>
            <i class="product-item-rate-icon fa-solid fa-star"></i>
            <i class="product-item-rate-icon fa-solid fa-star"></i>
            <i class="product-item-rate-icon fa-solid fa-star"></i>
            <i class="product-item-rate-icon fa-solid fa-star"></i>
            <span class="product-item-rate-number">
                (${product.vote} đánh giá)
            </span>
        </div>
    </div>
    `
})
.join('')

// render cart
function renderCart(){
var productsMua = 
    products.filter((product) => product.luotMua > 0)
            .map((product) => `
                <!-- item 0 -->
                <div class="buy-done-item" data-index="${product.id}">
                    <div class="buy-done-item-pic">
                        <img class="buy-done-item-img" src="${product.img + '.webp'}" alt="" >
                    </div>
                    <div class="buy-done-item-info">
                        <div class="buy-done-item-title">
                           ${product.title}
                        </div>
                        <span class="buy-done-item-price">
                            ${product.price + '.000đ'}
                        </span>
                        <div class="buy-done-item-btn">
                            <span class="buy-done-item-btn-distract" data-index="${product.id}">
                                -
                            </span>
                            <span class="buy-done-item-number">
                                ${product.luotMua}
                            </span>
                            <span class="buy-done-item-btn-add" data-index="${product.id}">
                                +
                            </span>
                        </div>
                    </div>
                    <div class="buy-done-item-delete" data-index="${product.id}">
                        <i class="buy-done-item-delete-icon fa-solid fa-xmark"></i>
                    </div>
                </div>
            `)          
        cartItemList.innerHTML = productsMua.join('')
    tinhTien()
}

// handle click mua
mainProductList.onclick = (e) => {
    if(e.target.closest('.product-modal-buy')){
        let index = e.target.closest('.product-modal-buy').dataset.index;
        products[index].luotMua++;
        // render so luong mua
        tongLuotMua++;
        cartNumber.innerHTML = `${tongLuotMua}`
        renderCart()
    }
}

// handle cart
cartItemList.onclick = (e) => {
    if(e.target.closest('.buy-done-item-btn-add')){
        let index = e.target.dataset.index;
        products[index].luotMua++
        tongLuotMua++
        cartNumber.innerHTML = `${tongLuotMua}`
        renderCart()
    }
    if(e.target.closest('.buy-done-item-btn-distract')){
        console.log(e.target.dataset.index)
        let index = e.target.dataset.index;
        products[index].luotMua--
        tongLuotMua--
        cartNumber.innerHTML = `${tongLuotMua}`
        renderCart()
    }
    if(e.target.closest('.buy-done-item-delete')){

        let index = e.target.closest('.buy-done-item-delete').dataset.index;
        let boLuotMua = products[index].luotMua;
        tongLuotMua = tongLuotMua -boLuotMua;
        cartNumber.innerHTML = `${tongLuotMua}`
        products[index].luotMua = 0;
        console.log(products[index].luotMua)
        renderCart()
    }
}
